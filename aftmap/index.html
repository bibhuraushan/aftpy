
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../getaftdata/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>AFTMap - AFTpy</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#aftpy.aftmap" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="AFTpy" class="md-header__button md-logo" aria-label="AFTpy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AFTpy
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              AFTMap
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="AFTpy" class="md-nav__button md-logo" aria-label="AFTpy" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    AFTpy
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AFTpy
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    AFTMap
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    AFTMap
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#aftpy.aftmap" class="md-nav__link">
    <span class="md-ellipsis">
      aftpy.aftmap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap" class="md-nav__link">
    <span class="md-ellipsis">
      AFTmap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AFTmap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.ADP" class="md-nav__link">
    <span class="md-ellipsis">
      ADP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.EDP" class="md-nav__link">
    <span class="md-ellipsis">
      EDP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.aftmap" class="md-nav__link">
    <span class="md-ellipsis">
      aftmap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="aftmap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.aftmap--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.area" class="md-nav__link">
    <span class="md-ellipsis">
      area
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
    <nav class="md-nav" aria-label="contents">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.contents--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.flux" class="md-nav__link">
    <span class="md-ellipsis">
      flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.info" class="md-nav__link">
    <span class="md-ellipsis">
      info
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.magmap" class="md-nav__link">
    <span class="md-ellipsis">
      magmap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="magmap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.magmap--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.mask" class="md-nav__link">
    <span class="md-ellipsis">
      mask
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mask">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.mask--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.metadata" class="md-nav__link">
    <span class="md-ellipsis">
      metadata
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.pfN" class="md-nav__link">
    <span class="md-ellipsis">
      pfN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.pfS" class="md-nav__link">
    <span class="md-ellipsis">
      pfS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.vlat" class="md-nav__link">
    <span class="md-ellipsis">
      vlat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.vlon" class="md-nav__link">
    <span class="md-ellipsis">
      vlon
    </span>
  </a>
  
    <nav class="md-nav" aria-label="vlon">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.vlon--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.__init__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__str__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.__str__--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.convert" class="md-nav__link">
    <span class="md-ellipsis">
      convert()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="convert()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.convert--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.convert--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.dipole" class="md-nav__link">
    <span class="md-ellipsis">
      dipole()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dipole()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.dipole--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.plot--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.plot--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.polarfield" class="md-nav__link">
    <span class="md-ellipsis">
      polarfield()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="polarfield()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.polarfield--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.polarfield--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps" class="md-nav__link">
    <span class="md-ellipsis">
      AFTmaps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AFTmaps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.aftmaps" class="md-nav__link">
    <span class="md-ellipsis">
      aftmaps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.timestamps" class="md-nav__link">
    <span class="md-ellipsis">
      timestamps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="timestamps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.timestamps--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.__init__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.convert_all" class="md-nav__link">
    <span class="md-ellipsis">
      convert_all()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="convert_all()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.convert_all--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.generate_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      generate_parameters()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generate_parameters()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.generate_parameters--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.get_filelist" class="md-nav__link">
    <span class="md-ellipsis">
      get_filelist()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_filelist()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.get_filelist--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.get_filenames" class="md-nav__link">
    <span class="md-ellipsis">
      get_filenames()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_filenames()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.get_filenames--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.stats" class="md-nav__link">
    <span class="md-ellipsis">
      stats()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../getaftdata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GetAFTData
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#aftpy.aftmap" class="md-nav__link">
    <span class="md-ellipsis">
      aftpy.aftmap
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap" class="md-nav__link">
    <span class="md-ellipsis">
      AFTmap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AFTmap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.ADP" class="md-nav__link">
    <span class="md-ellipsis">
      ADP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.EDP" class="md-nav__link">
    <span class="md-ellipsis">
      EDP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.aftmap" class="md-nav__link">
    <span class="md-ellipsis">
      aftmap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="aftmap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.aftmap--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.area" class="md-nav__link">
    <span class="md-ellipsis">
      area
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.contents" class="md-nav__link">
    <span class="md-ellipsis">
      contents
    </span>
  </a>
  
    <nav class="md-nav" aria-label="contents">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.contents--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.flux" class="md-nav__link">
    <span class="md-ellipsis">
      flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.info" class="md-nav__link">
    <span class="md-ellipsis">
      info
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.magmap" class="md-nav__link">
    <span class="md-ellipsis">
      magmap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="magmap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.magmap--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.mask" class="md-nav__link">
    <span class="md-ellipsis">
      mask
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mask">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.mask--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.metadata" class="md-nav__link">
    <span class="md-ellipsis">
      metadata
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.pfN" class="md-nav__link">
    <span class="md-ellipsis">
      pfN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.pfS" class="md-nav__link">
    <span class="md-ellipsis">
      pfS
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.vlat" class="md-nav__link">
    <span class="md-ellipsis">
      vlat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.vlon" class="md-nav__link">
    <span class="md-ellipsis">
      vlon
    </span>
  </a>
  
    <nav class="md-nav" aria-label="vlon">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.vlon--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.__init__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.__repr__" class="md-nav__link">
    <span class="md-ellipsis">
      __repr__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__str__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.__str__--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.convert" class="md-nav__link">
    <span class="md-ellipsis">
      convert()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="convert()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.convert--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.convert--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.dipole" class="md-nav__link">
    <span class="md-ellipsis">
      dipole()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dipole()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.dipole--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="plot()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.plot--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.plot--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.polarfield" class="md-nav__link">
    <span class="md-ellipsis">
      polarfield()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="polarfield()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.polarfield--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmap.polarfield--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps" class="md-nav__link">
    <span class="md-ellipsis">
      AFTmaps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="AFTmaps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.aftmaps" class="md-nav__link">
    <span class="md-ellipsis">
      aftmaps
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.timestamps" class="md-nav__link">
    <span class="md-ellipsis">
      timestamps
    </span>
  </a>
  
    <nav class="md-nav" aria-label="timestamps">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.timestamps--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="__init__()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.__init__--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.__len__" class="md-nav__link">
    <span class="md-ellipsis">
      __len__()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.convert_all" class="md-nav__link">
    <span class="md-ellipsis">
      convert_all()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="convert_all()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.convert_all--parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.generate_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      generate_parameters()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="generate_parameters()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.generate_parameters--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.get_filelist" class="md-nav__link">
    <span class="md-ellipsis">
      get_filelist()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_filelist()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.get_filelist--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.get_filenames" class="md-nav__link">
    <span class="md-ellipsis">
      get_filenames()
    </span>
  </a>
  
    <nav class="md-nav" aria-label="get_filenames()">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.get_filenames--returns" class="md-nav__link">
    <span class="md-ellipsis">
      Returns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#aftpy.aftmap.AFTmaps.stats" class="md-nav__link">
    <span class="md-ellipsis">
      stats()
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>AFTMap</h1>

<p>This part of the project documentation focuses on
<code>AFtmap</code> project code.</p>


  <div class="doc doc-object doc-module">

<a id="aftpy.aftmap"></a>
    <div class="doc doc-contents first">




  <div class="doc doc-children">









  <div class="doc doc-object doc-class">



<h2 id="aftpy.aftmap.AFTmap" class="doc doc-heading">
        <code>
AFTmap        </code>



</h2>

    <div class="doc doc-contents ">

      <p>A class to work with AFT maps.</p>
      <ul>
<li>nx (int): Number of pixels in the x-direction.</li>
<li>ny (int): Number of pixels in the y-direction.</li>
<li>dlat (float): Latitude step size.</li>
<li>dlatlon (float): Latitude and longitude step size.</li>
</ul>
<p>Methods:
- aftmap (property): Get the AFT map.
- mask (property): Get the mask.
- vv (property): Get the vlat and vlon.
- metadata (property): Get the metadata.
- info (property): Get additional information.
- <strong>str</strong>(): Return a string representation of the object.
- view(): Display or save the AFT map visualization.</p>

        <details class="quote">
          <summary>Source code in <code>aftpy/aftmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">AFTmap</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to work with AFT maps.</span>

<span class="sd">    Attributes:</span>
<span class="sd">    - nx (int): Number of pixels in the x-direction.</span>
<span class="sd">    - ny (int): Number of pixels in the y-direction.</span>
<span class="sd">    - dlat (float): Latitude step size.</span>
<span class="sd">    - dlatlon (float): Latitude and longitude step size.</span>

<span class="sd">    Methods:</span>
<span class="sd">    - aftmap (property): Get the AFT map.</span>
<span class="sd">    - mask (property): Get the mask.</span>
<span class="sd">    - vv (property): Get the vlat and vlon.</span>
<span class="sd">    - metadata (property): Get the metadata.</span>
<span class="sd">    - info (property): Get additional information.</span>
<span class="sd">    - __str__(): Return a string representation of the object.</span>
<span class="sd">    - view(): Display or save the AFT map visualization.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">nx</span> <span class="o">=</span> <span class="mi">1024</span>
    <span class="n">ny</span> <span class="o">=</span> <span class="mi">512</span>
    <span class="n">dlat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">ny</span>
    <span class="n">dlon</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">nx</span>
    <span class="n">latd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">ny</span><span class="p">)</span> <span class="o">*</span> <span class="mf">180.0</span> <span class="o">/</span> <span class="n">ny</span> <span class="o">-</span> <span class="mf">90.0</span><span class="p">,</span> <span class="p">(</span><span class="n">nx</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
    <span class="n">lond</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">nx</span><span class="p">)</span> <span class="o">*</span> <span class="mf">360.0</span> <span class="o">/</span> <span class="n">nx</span><span class="p">,</span> <span class="p">(</span><span class="n">ny</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">latr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">latd</span><span class="p">)</span>
    <span class="n">lonr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">lond</span><span class="p">)</span>
    <span class="n">contents_info</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;aftmap&quot;</span><span class="p">:</span> <span class="s2">&quot;AFT Baseline Map.&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;mask&quot;</span><span class="p">:</span> <span class="s2">&quot;Region of Data Assimilation.&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;vlat&quot;</span><span class="p">:</span> <span class="s2">&quot;Theta Component of flows at the surface.&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;vlon&quot;</span><span class="p">:</span> <span class="s2">&quot;Phi Component of flows at the surface.&quot;</span><span class="p">,</span>
                     <span class="s2">&quot;magmap&quot;</span><span class="p">:</span> <span class="s2">&quot;Assimilated magnetogram in Carrington Grid.&quot;</span><span class="p">}</span>
    <span class="n">fileext</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;aftmap&quot;</span><span class="p">:</span> <span class="s2">&quot;h5&quot;</span><span class="p">,</span> <span class="s2">&quot;oldaft&quot;</span><span class="p">:</span> <span class="s2">&quot;dat&quot;</span><span class="p">,</span> <span class="s2">&quot;hipft&quot;</span><span class="p">:</span> <span class="s2">&quot;h5&quot;</span><span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;aftmap&quot;</span><span class="p">,</span>
                 <span class="n">date_fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;AFTmap_%Y%m</span><span class="si">%d</span><span class="s2">_%H%M.h5&quot;</span><span class="p">,</span>
                 <span class="n">timestamp</span><span class="p">:</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize an AFTmap object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        file: str</span>
<span class="sd">        Name of the to be loaded or read.</span>
<span class="sd">        filetype: str, optional</span>
<span class="sd">        Type of the file to load. Default is &quot;h5&quot;</span>
<span class="sd">        date_fmt:str, optional</span>
<span class="sd">        Date format of the file. Default is &quot;AFTmap_%Y%m%d_%H%M.h5&quot;</span>
<span class="sd">        timestamp: dt.datetime, optional</span>
<span class="sd">        Timestamp of the file if filetype is &quot;hipft&quot;. Default is dt.datetime</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">=</span> <span class="n">filetype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date_fmt</span> <span class="o">=</span> <span class="n">date_fmt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_list</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">timestamp</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;aftmap&quot;</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">hdf</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">fl</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">map_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">_key</span> <span class="k">for</span> <span class="n">_key</span> <span class="ow">in</span> <span class="n">fl</span><span class="p">[</span><span class="s2">&quot;maps&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">map_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;aftmap&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;hipft&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Timestamp not provided. Assuming today as the timestamp.&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">())</span><span class="o">.</span><span class="n">fits</span>
        <span class="k">elif</span> <span class="n">timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">fits</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">contents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the contents of the AFTmap file as list.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        maplist: list</span>
<span class="sd">        Contents of the AFTmap file.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_list</span>

    <span class="c1"># ============================================================</span>
    <span class="c1"># Data attributes associated with file</span>
    <span class="c1"># ============================================================</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">_time</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;aftmap&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;map_date&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;oldaft&quot;</span><span class="p">:</span>
            <span class="n">_time</span> <span class="o">=</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_fmt</span><span class="p">)</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;hipft&quot;</span><span class="p">:</span>
            <span class="n">_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span>
        <span class="k">return</span> <span class="n">_time</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ymd</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
        <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">year</span><span class="p">,</span> <span class="n">month</span><span class="p">,</span> <span class="n">day</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">aftmap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the AFT map data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        aftmap: ndarray</span>
<span class="sd">        The AFT map file.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;aftmap&quot;</span><span class="p">:</span>
            <span class="c1"># For HDF file</span>
            <span class="k">with</span> <span class="n">hdf</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">fl</span><span class="p">:</span>
                <span class="n">bmap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fl</span><span class="p">[</span><span class="s2">&quot;maps/aftmap&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;oldaft&quot;</span><span class="p">:</span>
            <span class="c1"># For old dat file</span>
            <span class="n">_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">_data</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">512</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">:</span>
                <span class="n">bmap</span> <span class="o">=</span> <span class="n">_data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">bmap</span> <span class="o">=</span> <span class="n">_data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">int</span><span class="p">(</span><span class="mi">512</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;hipft&quot;</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">hdf</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">fl</span><span class="p">:</span>
                <span class="n">bmap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fl</span><span class="p">[</span><span class="s2">&quot;Data&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bmap</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">bmap</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mask</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the mask data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        mask: ndarray</span>
<span class="sd">        The region where data assimilation has been performed.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;mask&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_list</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">hdf</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">fl</span><span class="p">:</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fl</span><span class="p">[</span><span class="s2">&quot;maps/mask&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;dat&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span><span class="s2">&quot;No Mask File found in dat file.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">mask</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">magmap</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the hmi assimilated data if available.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        magmap: ndarray</span>
<span class="sd">        The hmi assimilated data if available.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;magmap&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_list</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">hdf</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">fl</span><span class="p">:</span>
                <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fl</span><span class="p">[</span><span class="s2">&quot;maps/magmap&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;dat&quot;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Warning</span><span class="p">(</span><span class="s2">&quot;No Mask File found in dat file.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">mask</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vlat</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ndarray</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get vlat data.</span>

<span class="sd">        Returns:</span>
<span class="sd">        - vlat (numpy.ndarray): Vlat data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;vlat&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_list</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">hdf</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">fl</span><span class="p">:</span>
                <span class="n">vlat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fl</span><span class="p">[</span><span class="s2">&quot;maps/vlat&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vlat</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">vlat</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">vlon</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ndarray</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get vlon data.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        vlon: ndarray[Any, dtype[Any]]</span>
<span class="sd">        Vlon data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s2">&quot;vlon&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_list</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">hdf</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">fl</span><span class="p">:</span>
                <span class="n">vlon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">fl</span><span class="p">[</span><span class="s2">&quot;maps/vlon&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">vlon</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">vlon</span>

    <span class="c1"># ============================================================</span>
    <span class="c1"># Metadata and header from AFT maps</span>
    <span class="c1"># ============================================================</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">metadata</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get metadata.</span>

<span class="sd">        Returns:</span>
<span class="sd">        - header (dict): Metadata.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">header</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;aftmap&quot;</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">hdf</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">fl</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">_key</span> <span class="ow">in</span> <span class="n">fl</span><span class="p">[</span><span class="s2">&quot;header&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">_val</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fl</span><span class="p">[</span><span class="s2">&quot;header&quot;</span><span class="p">][</span><span class="n">_key</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">_val</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
                        <span class="n">_val</span> <span class="o">=</span> <span class="n">_val</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                    <span class="n">header</span><span class="p">[</span><span class="n">_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">_val</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">header</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">header</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">header</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">fits</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">Header</span><span class="p">:</span>
        <span class="n">_headeraft</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
        <span class="n">date</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">time</span>
        <span class="n">observer</span> <span class="o">=</span> <span class="n">get_earth</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
        <span class="n">_header</span> <span class="o">=</span> <span class="n">make_heliographic_header</span><span class="p">(</span><span class="n">date</span><span class="p">,</span> <span class="n">observer</span><span class="p">,</span> <span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">1024</span><span class="p">),</span>
                                           <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;carrington&#39;</span><span class="p">,</span>
                                           <span class="n">projection_code</span><span class="o">=</span><span class="s2">&quot;CAR&quot;</span><span class="p">,</span>
                                           <span class="n">map_center_longitude</span><span class="o">=</span><span class="mi">180</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
        <span class="n">_header</span><span class="p">[</span><span class="s1">&#39;hgln_obs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;crln_obs&quot;</span><span class="p">]</span>
        <span class="n">_header</span><span class="p">[</span><span class="s1">&#39;hglt_obs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span><span class="p">[</span><span class="s2">&quot;crlt_obs&quot;</span><span class="p">]</span>
        <span class="n">header</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">header</span><span class="o">.</span><span class="n">Header</span><span class="p">(</span><span class="n">_header</span><span class="p">)</span>
        <span class="n">header</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">_headeraft</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">header</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">info</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get additional information.</span>

<span class="sd">        Returns:</span>
<span class="sd">        - info (dict): Additional information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">info</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;aftmap&quot;</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">hdf</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">fl</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">_key</span> <span class="ow">in</span> <span class="n">fl</span><span class="p">[</span><span class="s2">&quot;header&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">_info</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">fl</span><span class="p">[</span><span class="s2">&quot;header&quot;</span><span class="p">][</span><span class="n">_key</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;descr&quot;</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
                    <span class="k">except</span><span class="p">:</span>
                        <span class="n">_info</span> <span class="o">=</span> <span class="s2">&quot;None&quot;</span>
                    <span class="n">info</span><span class="p">[</span><span class="n">_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">_info</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">info</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="n">info</span>

    <span class="c1"># ============================================================</span>
    <span class="c1"># Field parameters from AFT maps;</span>
    <span class="c1"># Polar field and dipole moments</span>
    <span class="c1"># ============================================================</span>

    <span class="k">def</span> <span class="nf">polarfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monopole_corr</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">latlim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A helper function which returns the the polar fields for nortjern hemisphere and southern</span>
<span class="sd">        hemisphere in the given latitude limits.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        monopole_corr: bool</span>
<span class="sd">        Whether to apply a monopole correction to the AFT map or not. Defaults to True.</span>
<span class="sd">        latlim: float</span>
<span class="sd">        Latitude range in which polar field will be calculated. Defaults to 60.</span>
<span class="sd">        kwargs: dict</span>
<span class="sd">        Additional keyword.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pf: list</span>
<span class="sd">        2 dimensional array of type list.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coslat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latr</span><span class="p">)</span>
        <span class="n">_aftmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aftmap</span>
        <span class="k">if</span> <span class="n">monopole_corr</span><span class="p">:</span>
            <span class="n">_mp</span> <span class="o">=</span> <span class="p">(</span><span class="n">_aftmap</span> <span class="o">*</span> <span class="n">coslat</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">coslat</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="n">_aftmap</span> <span class="o">=</span> <span class="n">_aftmap</span> <span class="o">-</span> <span class="n">_mp</span>

        <span class="n">_aftmap</span> <span class="o">=</span> <span class="n">_aftmap</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">latstrip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latd</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">indN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">latstrip</span> <span class="o">&gt;=</span> <span class="n">latlim</span><span class="p">)</span>
        <span class="n">indS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">latstrip</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">latlim</span><span class="p">)</span>
        <span class="n">latstrip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">latstrip</span><span class="p">)</span>
        <span class="n">pfN</span> <span class="o">=</span> <span class="p">(</span><span class="n">_aftmap</span><span class="p">[</span><span class="n">indN</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">latstrip</span><span class="p">[</span><span class="n">indN</span><span class="p">]))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">latstrip</span><span class="p">[</span><span class="n">indN</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">pfS</span> <span class="o">=</span> <span class="p">(</span><span class="n">_aftmap</span><span class="p">[</span><span class="n">indS</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">latstrip</span><span class="p">[</span><span class="n">indS</span><span class="p">]))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">latstrip</span><span class="p">[</span><span class="n">indS</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">pfN</span><span class="p">,</span> <span class="n">pfS</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">dipole</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monopole_corr</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to calculate the axial and equatorial dipole moments of</span>
<span class="sd">        the AFTMap object.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        monopole_corr: bool</span>
<span class="sd">        Whether to correct monopole correction or not. Defaults to True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        dipole: tuple</span>
<span class="sd">        A tuple containing the axial and equatorial dipole moments.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coslat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latr</span><span class="p">)</span>
        <span class="n">sinlat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latr</span><span class="p">)</span>
        <span class="n">coslon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lonr</span><span class="p">)</span>
        <span class="n">sinlon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lonr</span><span class="p">)</span>
        <span class="n">_aftmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aftmap</span>
        <span class="k">if</span> <span class="n">monopole_corr</span><span class="p">:</span>
            <span class="n">_mp</span> <span class="o">=</span> <span class="p">(</span><span class="n">_aftmap</span> <span class="o">*</span> <span class="n">coslat</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">coslat</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="n">_aftmap</span> <span class="o">=</span> <span class="n">_aftmap</span> <span class="o">-</span> <span class="n">_mp</span>

        <span class="c1"># Axial dipole</span>
        <span class="n">_adipole</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_aftmap</span> <span class="o">*</span> <span class="n">coslat</span> <span class="o">*</span> <span class="n">sinlat</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlat</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlon</span>

        <span class="c1"># Equtorial Dipole</span>
        <span class="n">_edipolex</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_aftmap</span> <span class="o">*</span> <span class="n">sinlat</span> <span class="o">*</span> <span class="n">sinlat</span> <span class="o">*</span> <span class="n">coslon</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlat</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlon</span>
        <span class="n">_edipoley</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_aftmap</span> <span class="o">*</span> <span class="n">sinlat</span> <span class="o">*</span> <span class="n">sinlat</span> <span class="o">*</span> <span class="n">sinlon</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlat</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlon</span>
        <span class="n">_edipole</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">_edipolex</span><span class="p">,</span> <span class="n">_edipoley</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_adipole</span><span class="p">,</span> <span class="n">_edipole</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the area of each pixel grids.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        area : ndarray</span>
<span class="sd">        The area of each pixel grids.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">R</span> <span class="o">=</span> <span class="n">constants</span><span class="o">.</span><span class="n">radius</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="mf">100.0</span>
        <span class="n">area</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">R</span> <span class="o">/</span> <span class="mf">1024.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">R</span> <span class="o">/</span> <span class="mf">1024.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">area</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">flux</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Flux of each pixel grids.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        flux : ndarray</span>
<span class="sd">        The flux of each pixel grids.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">aftmap</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">area</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pfN</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Polar field for Northern Hemisphere.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pfN: float</span>
<span class="sd">        The polar field for Northern Hemisphere.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">polarfield</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pfS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Polar field for Southern Hemisphere.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        pfS: float</span>
<span class="sd">        The polar field for Southern Hemisphere.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">polarfield</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">ADP</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        ADP of the Sun.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        adp: float</span>
<span class="sd">        ADP of the Sun.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dipole</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">EDP</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        EDP of the Sun.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        EDP: float</span>
<span class="sd">        EDP of the Sun.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dipole</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># ============================================================</span>
    <span class="c1"># Conversion of AFT map in various formats</span>
    <span class="c1"># ============================================================</span>

    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">convert_to</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;fits&quot;</span><span class="p">,</span> <span class="n">outpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to convert all the files in the given directory and save them in</span>
<span class="sd">        outpath directory with the proper directory structure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        convert_to: str, optionals</span>
<span class="sd">        The type of converted files.</span>
<span class="sd">        outpath: str, optionals</span>
<span class="sd">        The path to save the converted files.</span>
<span class="sd">        verbose:bool, optionals</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        object</span>
<span class="sd">        Whether to show progress.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;aftmap&quot;</span><span class="p">:</span>
            <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aftmap</span>
            <span class="k">if</span> <span class="n">convert_to</span> <span class="o">==</span> <span class="s2">&quot;fits&quot;</span><span class="p">:</span>
                <span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
                <span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output written to </span><span class="si">{</span><span class="n">outpath</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">convert_to</span> <span class="o">==</span> <span class="s2">&quot;png&quot;</span><span class="p">:</span>
                <span class="n">show_mask</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;show_mask&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;show_mask&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">False</span>
                <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">show_mask</span><span class="o">=</span><span class="n">show_mask</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">outpath</span><span class="o">=</span><span class="n">outpath</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No implemented Yet.&quot;</span><span class="p">)</span>

    <span class="c1"># ============================================================</span>
    <span class="c1"># Visulaisation of AFT maps;</span>
    <span class="c1"># ============================================================</span>
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show_mask</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">outpath</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Display or save the AFT map visualization.</span>

<span class="sd">        Args:</span>
<span class="sd">        - para (str, optional): Parameter to display (&quot;aftmap&quot; or &quot;mask&quot;). Defaults to &quot;aftmap&quot;.</span>
<span class="sd">        - save (bool, optional): Whether to save the visualization as an image. Defaults to False.</span>

<span class="sd">        Returns:</span>
<span class="sd">        - fig (matplotlib.figure.Figure): The Figure object.</span>
<span class="sd">        - ax (matplotlib.axes._axes.Axes): The AxesSubplot object.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        outpath: str</span>
<span class="sd">        The path to save the.</span>
<span class="sd">        show_mask: bool, optional</span>
<span class="sd">        Whether to show the mask of the AFT map. Defaults to True</span>
<span class="sd">        save: bool, optional</span>
<span class="sd">        Whether to save the visualization as an image. Defaults to False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        fig, object:</span>
<span class="sd">        The Figure object.</span>
<span class="sd">        ax: matplotlib.axes._axes.AxesSubplot</span>
<span class="sd">        The AxesSubplot object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Longitude [degree]&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Latitude [degree]&quot;</span><span class="p">)</span>
        <span class="n">_extent</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>

        <span class="n">bmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aftmap</span>

        <span class="n">icm</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">bmap</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">_extent</span><span class="p">,</span>
                        <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;hmimag&quot;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1000</span><span class="p">)</span>

        <span class="n">axc</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.92</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">icm</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">axc</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$B$ [G]&quot;</span><span class="p">)</span>
        <span class="n">axc</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">axc</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
        <span class="n">_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">750</span><span class="p">]</span>
        <span class="n">axc</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">_ticks</span><span class="p">,</span> <span class="n">_ticks</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
        <span class="n">axc</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">show_mask</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;aftmap&quot;</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">_extent</span><span class="p">,</span>
                       <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                       <span class="n">linestyles</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">outpath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outpath</span><span class="si">}</span><span class="s2">/&quot;</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

    <span class="c1"># ============================================================</span>
    <span class="c1"># Special functions for AFT maps;</span>
    <span class="c1"># ============================================================</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        String represenation of the AFTMap object.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str: str</span>
<span class="sd">        String representation of the AFTMap object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;AFTMap(time=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="si">}</span><span class="s2">, filtype=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a string representation of the object.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        str</span>
<span class="sd">        String representation of the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
        <span class="n">dct1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">30</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;aftmap&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">85</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">36</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;MAP CONTENTS&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">37</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">85</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_list</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%-10s</span><span class="s2">: </span><span class="si">%-30s</span><span class="s2"> - </span><span class="si">%-30s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">_key</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="s2">&quot;Array&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents_info</span><span class="p">[</span><span class="n">_key</span><span class="p">]))</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">85</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">39</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;HEADER&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">85</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%-10s</span><span class="s2">: </span><span class="si">%-30s</span><span class="s2"> - </span><span class="si">%-30s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">_key</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">dct</span><span class="p">[</span><span class="n">_key</span><span class="p">],</span> <span class="n">dct1</span><span class="p">[</span><span class="n">_key</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">85</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">39</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;AFT MAP&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">85</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
        <span class="k">return</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">85</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 id="aftpy.aftmap.AFTmap.ADP" class="doc doc-heading">
<code class="highlight language-python"><span class="n">ADP</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>ADP of the Sun.
Returns</p>
<hr />
<p>adp: float
ADP of the Sun.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="aftpy.aftmap.AFTmap.EDP" class="doc doc-heading">
<code class="highlight language-python"><span class="n">EDP</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>EDP of the Sun.
Returns</p>
<hr />
<p>EDP: float
EDP of the Sun.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="aftpy.aftmap.AFTmap.aftmap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">aftmap</span><span class="p">:</span> <span class="n">ndarray</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Get the AFT map data.</p>
<h5 id="aftpy.aftmap.AFTmap.aftmap--returns">Returns</h5>
<p>aftmap: ndarray
The AFT map file.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="aftpy.aftmap.AFTmap.area" class="doc doc-heading">
<code class="highlight language-python"><span class="n">area</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Calculate the area of each pixel grids.
Returns</p>
<hr />
<p>area : ndarray
The area of each pixel grids.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="aftpy.aftmap.AFTmap.contents" class="doc doc-heading">
<code class="highlight language-python"><span class="n">contents</span><span class="p">:</span> <span class="nb">list</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Returns the contents of the AFTmap file as list.</p>
<h5 id="aftpy.aftmap.AFTmap.contents--returns">Returns</h5>
<p>maplist: list
Contents of the AFTmap file.</p>
    </div>

  </div>







  <div class="doc doc-object doc-attribute">



<h3 id="aftpy.aftmap.AFTmap.flux" class="doc doc-heading">
<code class="highlight language-python"><span class="n">flux</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Flux of each pixel grids.
Returns</p>
<hr />
<p>flux : ndarray
The flux of each pixel grids.</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 id="aftpy.aftmap.AFTmap.info" class="doc doc-heading">
<code class="highlight language-python"><span class="n">info</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Get additional information.</p>
      <ul>
<li>info (dict): Additional information.</li>
</ul>
    </div>

  </div>







  <div class="doc doc-object doc-attribute">



<h3 id="aftpy.aftmap.AFTmap.magmap" class="doc doc-heading">
<code class="highlight language-python"><span class="n">magmap</span><span class="p">:</span> <span class="n">ndarray</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Get the hmi assimilated data if available.</p>
<h5 id="aftpy.aftmap.AFTmap.magmap--returns">Returns</h5>
<p>magmap: ndarray
The hmi assimilated data if available.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="aftpy.aftmap.AFTmap.mask" class="doc doc-heading">
<code class="highlight language-python"><span class="n">mask</span><span class="p">:</span> <span class="n">ndarray</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Get the mask data.</p>
<h5 id="aftpy.aftmap.AFTmap.mask--returns">Returns</h5>
<p>mask: ndarray
The region where data assimilation has been performed.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="aftpy.aftmap.AFTmap.metadata" class="doc doc-heading">
<code class="highlight language-python"><span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Get metadata.</p>
      <ul>
<li>header (dict): Metadata.</li>
</ul>
    </div>

  </div>





  <div class="doc doc-object doc-attribute">



<h3 id="aftpy.aftmap.AFTmap.pfN" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pfN</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Polar field for Northern Hemisphere.
Returns</p>
<hr />
<p>pfN: float
The polar field for Northern Hemisphere.</p>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="aftpy.aftmap.AFTmap.pfS" class="doc doc-heading">
<code class="highlight language-python"><span class="n">pfS</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Polar field for Southern Hemisphere.
Returns</p>
<hr />
<p>pfS: float
The polar field for Southern Hemisphere.</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 id="aftpy.aftmap.AFTmap.vlat" class="doc doc-heading">
<code class="highlight language-python"><span class="n">vlat</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Get vlat data.</p>
      <ul>
<li>vlat (numpy.ndarray): Vlat data.</li>
</ul>
    </div>

  </div>



  <div class="doc doc-object doc-attribute">



<h3 id="aftpy.aftmap.AFTmap.vlon" class="doc doc-heading">
<code class="highlight language-python"><span class="n">vlon</span><span class="p">:</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">Any</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">[</span><span class="n">Any</span><span class="p">]]</span> <span class="o">|</span> <span class="kc">None</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Get vlon data.</p>
<h5 id="aftpy.aftmap.AFTmap.vlon--returns">Returns</h5>
<p>vlon: ndarray[Any, dtype[Any]]
Vlon data.</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 id="aftpy.aftmap.AFTmap.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s1">&#39;aftmap&#39;</span><span class="p">,</span> <span class="n">date_fmt</span><span class="o">=</span><span class="s1">&#39;AFTmap_%Y%m</span><span class="si">%d</span><span class="s1">_%H%M.h5&#39;</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initialize an AFTmap object.</p>
<h5 id="aftpy.aftmap.AFTmap.__init__--parameters">Parameters</h5>
<p>file: str
Name of the to be loaded or read.
filetype: str, optional
Type of the file to load. Default is "h5"
date_fmt:str, optional
Date format of the file. Default is "AFTmap_%Y%m%d_%H%M.h5"
timestamp: dt.datetime, optional
Timestamp of the file if filetype is "hipft". Default is dt.datetime</p>

        <details class="quote">
          <summary>Source code in <code>aftpy/aftmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;aftmap&quot;</span><span class="p">,</span>
             <span class="n">date_fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;AFTmap_%Y%m</span><span class="si">%d</span><span class="s2">_%H%M.h5&quot;</span><span class="p">,</span>
             <span class="n">timestamp</span><span class="p">:</span> <span class="n">dt</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize an AFTmap object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    file: str</span>
<span class="sd">    Name of the to be loaded or read.</span>
<span class="sd">    filetype: str, optional</span>
<span class="sd">    Type of the file to load. Default is &quot;h5&quot;</span>
<span class="sd">    date_fmt:str, optional</span>
<span class="sd">    Date format of the file. Default is &quot;AFTmap_%Y%m%d_%H%M.h5&quot;</span>
<span class="sd">    timestamp: dt.datetime, optional</span>
<span class="sd">    Timestamp of the file if filetype is &quot;hipft&quot;. Default is dt.datetime</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">file</span> <span class="o">=</span> <span class="n">file</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">=</span> <span class="n">filetype</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">date_fmt</span> <span class="o">=</span> <span class="n">date_fmt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">map_list</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">timestamp</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;aftmap&quot;</span><span class="p">:</span>
        <span class="k">with</span> <span class="n">hdf</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file</span><span class="p">)</span> <span class="k">as</span> <span class="n">fl</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">map_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">_key</span> <span class="k">for</span> <span class="n">_key</span> <span class="ow">in</span> <span class="n">fl</span><span class="p">[</span><span class="s2">&quot;maps&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;aftmap&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;hipft&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Timestamp not provided. Assuming today as the timestamp.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">today</span><span class="p">())</span><span class="o">.</span><span class="n">fits</span>
    <span class="k">elif</span> <span class="n">timestamp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="n">timestamp</span><span class="p">)</span><span class="o">.</span><span class="n">fits</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="aftpy.aftmap.AFTmap.__repr__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>String represenation of the AFTMap object.
Returns</p>
<hr />
<p>str: str
String representation of the AFTMap object.</p>

        <details class="quote">
          <summary>Source code in <code>aftpy/aftmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    String represenation of the AFTMap object.</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str: str</span>
<span class="sd">    String representation of the AFTMap object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;AFTMap(time=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="si">}</span><span class="s2">, filtype=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="si">}</span><span class="s2">)&quot;</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="aftpy.aftmap.AFTmap.__str__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Get a string representation of the object.</p>
<h5 id="aftpy.aftmap.AFTmap.__str__--returns">Returns</h5>
<p>str
String representation of the object.</p>

        <details class="quote">
          <summary>Source code in <code>aftpy/aftmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get a string representation of the object.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">    String representation of the object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
    <span class="n">dct1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">30</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">30</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;aftmap&quot;</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">85</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">36</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;MAP CONTENTS&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">37</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">85</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">map_list</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%-10s</span><span class="s2">: </span><span class="si">%-30s</span><span class="s2"> - </span><span class="si">%-30s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">_key</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="s2">&quot;Array&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">contents_info</span><span class="p">[</span><span class="n">_key</span><span class="p">]))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">85</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">39</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;HEADER&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">85</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%-10s</span><span class="s2">: </span><span class="si">%-30s</span><span class="s2"> - </span><span class="si">%-30s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">_key</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">dct</span><span class="p">[</span><span class="n">_key</span><span class="p">],</span> <span class="n">dct1</span><span class="p">[</span><span class="n">_key</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">85</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">39</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;AFT MAP&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">40</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">85</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
    <span class="k">return</span> <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">85</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="aftpy.aftmap.AFTmap.convert" class="doc doc-heading">
<code class="highlight language-python"><span class="n">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">convert_to</span><span class="o">=</span><span class="s1">&#39;fits&#39;</span><span class="p">,</span> <span class="n">outpath</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Function to convert all the files in the given directory and save them in
outpath directory with the proper directory structure.</p>
<h5 id="aftpy.aftmap.AFTmap.convert--parameters">Parameters</h5>
<p>convert_to: str, optionals
The type of converted files.
outpath: str, optionals
The path to save the converted files.
verbose:bool, optionals</p>
<h5 id="aftpy.aftmap.AFTmap.convert--returns">Returns</h5>
<p>object
Whether to show progress.</p>

        <details class="quote">
          <summary>Source code in <code>aftpy/aftmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">convert_to</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;fits&quot;</span><span class="p">,</span> <span class="n">outpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to convert all the files in the given directory and save them in</span>
<span class="sd">    outpath directory with the proper directory structure.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    convert_to: str, optionals</span>
<span class="sd">    The type of converted files.</span>
<span class="sd">    outpath: str, optionals</span>
<span class="sd">    The path to save the converted files.</span>
<span class="sd">    verbose:bool, optionals</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    object</span>
<span class="sd">    Whether to show progress.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;aftmap&quot;</span><span class="p">:</span>
        <span class="n">header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aftmap</span>
        <span class="k">if</span> <span class="n">convert_to</span> <span class="o">==</span> <span class="s2">&quot;fits&quot;</span><span class="p">:</span>
            <span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
            <span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output written to </span><span class="si">{</span><span class="n">outpath</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">convert_to</span> <span class="o">==</span> <span class="s2">&quot;png&quot;</span><span class="p">:</span>
            <span class="n">show_mask</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;show_mask&quot;</span><span class="p">]</span> <span class="k">if</span> <span class="s2">&quot;show_mask&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="k">else</span> <span class="kc">False</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">show_mask</span><span class="o">=</span><span class="n">show_mask</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">outpath</span><span class="o">=</span><span class="n">outpath</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;No implemented Yet.&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="aftpy.aftmap.AFTmap.dipole" class="doc doc-heading">
<code class="highlight language-python"><span class="n">dipole</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monopole_corr</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Function to calculate the axial and equatorial dipole moments of
the AFTMap object.
Parameters</p>
<hr />
<p>monopole_corr: bool
Whether to correct monopole correction or not. Defaults to True.</p>
<h5 id="aftpy.aftmap.AFTmap.dipole--returns">Returns</h5>
<p>dipole: tuple
A tuple containing the axial and equatorial dipole moments.</p>

        <details class="quote">
          <summary>Source code in <code>aftpy/aftmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">dipole</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monopole_corr</span><span class="p">:</span> <span class="nb">object</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to calculate the axial and equatorial dipole moments of</span>
<span class="sd">    the AFTMap object.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    monopole_corr: bool</span>
<span class="sd">    Whether to correct monopole correction or not. Defaults to True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    dipole: tuple</span>
<span class="sd">    A tuple containing the axial and equatorial dipole moments.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">coslat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latr</span><span class="p">)</span>
    <span class="n">sinlat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latr</span><span class="p">)</span>
    <span class="n">coslon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lonr</span><span class="p">)</span>
    <span class="n">sinlon</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lonr</span><span class="p">)</span>
    <span class="n">_aftmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aftmap</span>
    <span class="k">if</span> <span class="n">monopole_corr</span><span class="p">:</span>
        <span class="n">_mp</span> <span class="o">=</span> <span class="p">(</span><span class="n">_aftmap</span> <span class="o">*</span> <span class="n">coslat</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">coslat</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">_aftmap</span> <span class="o">=</span> <span class="n">_aftmap</span> <span class="o">-</span> <span class="n">_mp</span>

    <span class="c1"># Axial dipole</span>
    <span class="n">_adipole</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_aftmap</span> <span class="o">*</span> <span class="n">coslat</span> <span class="o">*</span> <span class="n">sinlat</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlat</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlon</span>

    <span class="c1"># Equtorial Dipole</span>
    <span class="n">_edipolex</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_aftmap</span> <span class="o">*</span> <span class="n">sinlat</span> <span class="o">*</span> <span class="n">sinlat</span> <span class="o">*</span> <span class="n">coslon</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlat</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlon</span>
    <span class="n">_edipoley</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">4.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">_aftmap</span> <span class="o">*</span> <span class="n">sinlat</span> <span class="o">*</span> <span class="n">sinlat</span> <span class="o">*</span> <span class="n">sinlon</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlat</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dlon</span>
    <span class="n">_edipole</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hypot</span><span class="p">(</span><span class="n">_edipolex</span><span class="p">,</span> <span class="n">_edipoley</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_adipole</span><span class="p">,</span> <span class="n">_edipole</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="aftpy.aftmap.AFTmap.plot" class="doc doc-heading">
<code class="highlight language-python"><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show_mask</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">outpath</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Display or save the AFT map visualization.</p>
      <ul>
<li>para (str, optional): Parameter to display ("aftmap" or "mask"). Defaults to "aftmap".</li>
<li>save (bool, optional): Whether to save the visualization as an image. Defaults to False.</li>
</ul>
      <ul>
<li>fig (matplotlib.figure.Figure): The Figure object.</li>
<li>ax (matplotlib.axes._axes.Axes): The AxesSubplot object.</li>
</ul>
<h5 id="aftpy.aftmap.AFTmap.plot--parameters">Parameters</h5>
<p>outpath: str
The path to save the.
show_mask: bool, optional
Whether to show the mask of the AFT map. Defaults to True
save: bool, optional
Whether to save the visualization as an image. Defaults to False.</p>
<h5 id="aftpy.aftmap.AFTmap.plot--returns">Returns</h5>
<p>fig, object:
The Figure object.
ax: matplotlib.axes._axes.AxesSubplot
The AxesSubplot object.</p>

        <details class="quote">
          <summary>Source code in <code>aftpy/aftmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">show_mask</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">outpath</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display or save the AFT map visualization.</span>

<span class="sd">    Args:</span>
<span class="sd">    - para (str, optional): Parameter to display (&quot;aftmap&quot; or &quot;mask&quot;). Defaults to &quot;aftmap&quot;.</span>
<span class="sd">    - save (bool, optional): Whether to save the visualization as an image. Defaults to False.</span>

<span class="sd">    Returns:</span>
<span class="sd">    - fig (matplotlib.figure.Figure): The Figure object.</span>
<span class="sd">    - ax (matplotlib.axes._axes.Axes): The AxesSubplot object.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    outpath: str</span>
<span class="sd">    The path to save the.</span>
<span class="sd">    show_mask: bool, optional</span>
<span class="sd">    Whether to show the mask of the AFT map. Defaults to True</span>
<span class="sd">    save: bool, optional</span>
<span class="sd">    Whether to save the visualization as an image. Defaults to False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    fig, object:</span>
<span class="sd">    The Figure object.</span>
<span class="sd">    ax: matplotlib.axes._axes.AxesSubplot</span>
<span class="sd">    The AxesSubplot object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mf">3.5</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Longitude [degree]&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Latitude [degree]&quot;</span><span class="p">)</span>
    <span class="n">_extent</span> <span class="o">=</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">360</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>

    <span class="n">bmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aftmap</span>

    <span class="n">icm</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">bmap</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s2">&quot;lower&quot;</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">_extent</span><span class="p">,</span>
                    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;hmimag&quot;</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mi">1000</span><span class="p">)</span>

    <span class="n">axc</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.92</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">icm</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">axc</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;$B$ [G]&quot;</span><span class="p">)</span>
    <span class="n">axc</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">axc</span><span class="o">.</span><span class="n">minorticks_off</span><span class="p">()</span>
    <span class="n">_ticks</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">750</span><span class="p">,</span> <span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="o">-</span><span class="mi">250</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">250</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">750</span><span class="p">]</span>
    <span class="n">axc</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">_ticks</span><span class="p">,</span> <span class="n">_ticks</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">)</span>
    <span class="n">axc</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;out&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">show_mask</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;aftmap&quot;</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="n">_extent</span><span class="p">,</span>
                   <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;white&quot;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                   <span class="n">linestyles</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">outpath</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">outpath</span><span class="si">}</span><span class="s2">/&quot;</span> <span class="o">+</span> <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="aftpy.aftmap.AFTmap.polarfield" class="doc doc-heading">
<code class="highlight language-python"><span class="n">polarfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monopole_corr</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">latlim</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>A helper function which returns the the polar fields for nortjern hemisphere and southern
hemisphere in the given latitude limits.</p>
<h5 id="aftpy.aftmap.AFTmap.polarfield--parameters">Parameters</h5>
<p>monopole_corr: bool
Whether to apply a monopole correction to the AFT map or not. Defaults to True.
latlim: float
Latitude range in which polar field will be calculated. Defaults to 60.
kwargs: dict
Additional keyword.</p>
<h5 id="aftpy.aftmap.AFTmap.polarfield--returns">Returns</h5>
<p>pf: list
2 dimensional array of type list.</p>

        <details class="quote">
          <summary>Source code in <code>aftpy/aftmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">polarfield</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">monopole_corr</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">latlim</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">60</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A helper function which returns the the polar fields for nortjern hemisphere and southern</span>
<span class="sd">    hemisphere in the given latitude limits.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    monopole_corr: bool</span>
<span class="sd">    Whether to apply a monopole correction to the AFT map or not. Defaults to True.</span>
<span class="sd">    latlim: float</span>
<span class="sd">    Latitude range in which polar field will be calculated. Defaults to 60.</span>
<span class="sd">    kwargs: dict</span>
<span class="sd">    Additional keyword.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    pf: list</span>
<span class="sd">    2 dimensional array of type list.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">coslat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latr</span><span class="p">)</span>
    <span class="n">_aftmap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">aftmap</span>
    <span class="k">if</span> <span class="n">monopole_corr</span><span class="p">:</span>
        <span class="n">_mp</span> <span class="o">=</span> <span class="p">(</span><span class="n">_aftmap</span> <span class="o">*</span> <span class="n">coslat</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">coslat</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">_aftmap</span> <span class="o">=</span> <span class="n">_aftmap</span> <span class="o">-</span> <span class="n">_mp</span>

    <span class="n">_aftmap</span> <span class="o">=</span> <span class="n">_aftmap</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">latstrip</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latd</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">indN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">latstrip</span> <span class="o">&gt;=</span> <span class="n">latlim</span><span class="p">)</span>
    <span class="n">indS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">latstrip</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">latlim</span><span class="p">)</span>
    <span class="n">latstrip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="n">latstrip</span><span class="p">)</span>
    <span class="n">pfN</span> <span class="o">=</span> <span class="p">(</span><span class="n">_aftmap</span><span class="p">[</span><span class="n">indN</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">latstrip</span><span class="p">[</span><span class="n">indN</span><span class="p">]))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">latstrip</span><span class="p">[</span><span class="n">indN</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">pfS</span> <span class="o">=</span> <span class="p">(</span><span class="n">_aftmap</span><span class="p">[</span><span class="n">indS</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">latstrip</span><span class="p">[</span><span class="n">indS</span><span class="p">]))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">latstrip</span><span class="p">[</span><span class="n">indS</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">pfN</span><span class="p">,</span> <span class="n">pfS</span><span class="p">]</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>



  <div class="doc doc-object doc-class">



<h2 id="aftpy.aftmap.AFTmaps" class="doc doc-heading">
        <code>
AFTmaps        </code>



</h2>

    <div class="doc doc-contents ">

      <p>A class for loading all AFT maps from a given directory.
This class will initialize with getting all the list of files
and crete the time stamp and Carrington Rotation Number out of it.</p>
      <ul>
<li>path (str): The path to the directory containing AFT map files.</li>
<li>filetype (str): The file extension of the AFT map files (e.g., "h5").</li>
<li>date_fmt (str): The date format string used to parse timestamps from filenames.</li>
<li>filelist (list): A list of file paths to AFT map files in the specified directory.</li>
<li>filenames (numpy.ndarray): An array of filenames extracted from the filelist.</li>
</ul>

        <details class="quote">
          <summary>Source code in <code>aftpy/aftmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">class</span> <span class="nc">AFTmaps</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A class for loading all AFT maps from a given directory.</span>
<span class="sd">        This class will initialize with getting all the list of files</span>
<span class="sd">        and crete the time stamp and Carrington Rotation Number out of it.</span>

<span class="sd">        Attributes:</span>
<span class="sd">        - path (str): The path to the directory containing AFT map files.</span>
<span class="sd">        - filetype (str): The file extension of the AFT map files (e.g., &quot;h5&quot;).</span>
<span class="sd">        - date_fmt (str): The date format string used to parse timestamps from filenames.</span>
<span class="sd">        - filelist (list): A list of file paths to AFT map files in the specified directory.</span>
<span class="sd">        - filenames (numpy.ndarray): An array of filenames extracted from the filelist.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">filetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;aftmap&quot;</span><span class="p">,</span>
                 <span class="n">date_fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;AFTmap_%Y%m</span><span class="si">%d</span><span class="s2">_%H%M.h5&quot;</span><span class="p">,</span> <span class="n">monopole_corr</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">hipft_prop</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initilaizing class function.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        path: str, optional</span>
<span class="sd">        The path to the AFT map file. Defaults to the current working directory.</span>
<span class="sd">        filetype: str, optional</span>
<span class="sd">        The file extension of the AFT map. Default to the &quot;h5&quot;</span>
<span class="sd">        date_fmt:str, optional</span>
<span class="sd">        The date format string. Defaults to the &quot;AFTmap_%Y%m%d_%H%M.h5&quot;</span>
<span class="sd">        verbose:bool, optional</span>
<span class="sd">        Whether to print or not. Defaults to the True</span>
<span class="sd">        hipft_prop: dict, optional</span>
<span class="sd">        A dictionary for hipft properties, if filetype is &quot;hipft&quot;, the hipft</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">=</span> <span class="n">filetype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">date_fmt</span> <span class="o">=</span> <span class="n">date_fmt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">monopole_corr</span> <span class="o">=</span> <span class="n">monopole_corr</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fileext</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;aftmap&quot;</span><span class="p">:</span> <span class="s2">&quot;h5&quot;</span><span class="p">,</span> <span class="s2">&quot;oldaft&quot;</span><span class="p">:</span> <span class="s2">&quot;dat&quot;</span><span class="p">,</span> <span class="s2">&quot;hipft&quot;</span><span class="p">:</span> <span class="s2">&quot;h5&quot;</span><span class="p">}</span>

        <span class="c1"># Whether it is a list of paths or one path</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
            <span class="n">filelist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
            <span class="k">for</span> <span class="n">_path</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
                <span class="n">_filelist</span> <span class="o">=</span> <span class="n">file_search</span><span class="p">(</span><span class="n">_path</span><span class="p">,</span> <span class="n">fileext</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_fileext</span><span class="p">[</span><span class="n">filetype</span><span class="p">])</span>
                <span class="n">filelist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filelist</span><span class="p">,</span> <span class="n">_filelist</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filelist</span> <span class="o">=</span> <span class="n">filelist</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">filelist</span> <span class="o">=</span> <span class="n">file_search</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">fileext</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_fileext</span><span class="p">[</span><span class="n">filetype</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">filenames</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hipft_prop</span> <span class="o">=</span> <span class="n">hipft_prop</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filenames</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;hipft&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hipft_prop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;HIPFT Time information not provided&quot;</span><span class="p">)</span>

        <span class="c1"># Carrington Parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_crn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">carrington_rotation_number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_CRN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_crn</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Length of the object.</span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        n: int</span>
<span class="sd">        Length of the object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&lt;AFTMaps(Path: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="si">}</span><span class="s2">, Type: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="si">}</span><span class="s2">, Total: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="si">}</span><span class="s2">)&gt;&quot;</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">crn</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CRN</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">aftmaps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        An itterator containing all the AFTmaps associated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">AFTmap</span><span class="p">(</span><span class="n">_file</span><span class="p">,</span> <span class="n">date_fmt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">date_fmt</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">timestamps</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        To get timestamps for all files in the AFT map directory.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        object</span>
<span class="sd">        List of timestamps corresponding to each AFT map in the directory.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_timestamp</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">!=</span> <span class="s2">&quot;hipft&quot;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">:</span>
                <span class="n">_timestamp</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dt</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">_file</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_fmt</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_t0</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hipft_prop</span><span class="p">[</span><span class="s2">&quot;T0&quot;</span><span class="p">]</span>
            <span class="n">_dt</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">hipft_prop</span><span class="p">[</span><span class="s2">&quot;dt&quot;</span><span class="p">]</span>
            <span class="n">_timestamp</span> <span class="o">=</span> <span class="p">[</span><span class="n">_t0</span> <span class="o">+</span> <span class="n">dt</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="n">_dt</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">))]</span>
        <span class="k">return</span> <span class="n">Time</span><span class="p">(</span><span class="n">_timestamp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_filelist</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        To get the full paths of the loaded files in the AFTmaps folder.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">        List of all files in the AFTmaps directory.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filelist</span>

    <span class="k">def</span> <span class="nf">get_filenames</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the names of the files in the AFTMap directory.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        np.ndarray</span>
<span class="sd">        list of filenames.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filenames</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Show the statistics of the loaded files.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_stats</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;RootDir&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;FileType&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span> <span class="s2">&quot;# Files&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">),</span>
                  <span class="s2">&quot;T-Initial&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;T-End&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]}</span>
        <span class="k">for</span> <span class="n">_s</span> <span class="ow">in</span> <span class="n">_stats</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%-10s</span><span class="s2">: </span><span class="si">%-30s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">_s</span><span class="p">,</span> <span class="n">_stats</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_s</span><span class="p">)))</span>

    <span class="k">def</span> <span class="nf">convert_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">convert_to</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;fits&quot;</span><span class="p">,</span> <span class="n">outpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert all loaded AFT map files to the specified format.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        convert_to: str, optional</span>
<span class="sd">        The output format to AFTMap to fits. Defaults to &quot;fits&quot;</span>
<span class="sd">        outpath: str, optional</span>
<span class="sd">        The directory in which to save the fits. Defaults to &quot;.&quot;</span>
<span class="sd">        Show progress. Defaults to True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">_file</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">))):</span>
            <span class="n">mapobj</span> <span class="o">=</span> <span class="n">AFTmap</span><span class="p">(</span><span class="n">_file</span><span class="p">)</span>
            <span class="n">yr</span><span class="p">,</span> <span class="n">mo</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">mapobj</span><span class="o">.</span><span class="n">ymd</span>
            <span class="n">_outpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mo</span><span class="p">))</span>
            <span class="n">_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">_file</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">convert_to</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">_outpath</span><span class="p">):</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">_outpath</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">convert_to</span> <span class="o">==</span> <span class="s2">&quot;png&quot;</span><span class="p">:</span>
                <span class="n">mapobj</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">convert_to</span><span class="o">=</span><span class="n">convert_to</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span> <span class="n">outpath</span><span class="o">=</span><span class="n">_outpath</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_outpath</span><span class="p">,</span> <span class="n">_filename</span><span class="p">)</span>
                <span class="n">mapobj</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">convert_to</span><span class="o">=</span><span class="n">convert_to</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span> <span class="n">outpath</span><span class="o">=</span><span class="n">_filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="n">frac</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">frac</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%) Converting </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">_file</span><span class="p">)</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">_filename</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_generate_para</span><span class="p">(</span><span class="n">filelist</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        A helper function to generate a aft parameters for a given file.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filelist: tuple</span>
<span class="sd">        The name of the file to generate the aft parameters.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        para: tuple</span>
<span class="sd">        A tuple containing the all the AFT parameters for the file.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">file</span><span class="p">,</span> <span class="n">filetype</span><span class="p">,</span> <span class="n">datefmt</span><span class="p">,</span> <span class="n">monopole_corr</span> <span class="o">=</span> <span class="n">filelist</span>
        <span class="n">mapobj</span> <span class="o">=</span> <span class="n">AFTmap</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="n">filetype</span><span class="p">,</span> <span class="n">date_fmt</span><span class="o">=</span><span class="n">datefmt</span><span class="p">)</span>
        <span class="n">tflux</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">mapobj</span><span class="o">.</span><span class="n">flux</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">pf</span> <span class="o">=</span> <span class="n">mapobj</span><span class="o">.</span><span class="n">polarfield</span><span class="p">(</span><span class="n">monopole_corr</span><span class="o">=</span><span class="n">monopole_corr</span><span class="p">)</span>
        <span class="n">dp</span> <span class="o">=</span> <span class="n">mapobj</span><span class="o">.</span><span class="n">dipole</span><span class="p">(</span><span class="n">monopole_corr</span><span class="o">=</span><span class="n">monopole_corr</span><span class="p">)</span>
        <span class="n">para</span> <span class="o">=</span> <span class="p">(</span><span class="n">mapobj</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="o">*</span><span class="n">pf</span><span class="p">,</span> <span class="o">*</span><span class="n">dp</span><span class="p">,</span> <span class="n">tflux</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">para</span>

    <span class="k">def</span> <span class="nf">generate_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nthreds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                            <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_saved</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Function to generate AFT data for all the files.</span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        use_saved: bool, optional</span>
<span class="sd">        Whether to relaod form saved file or not. Defaults to True.</span>
<span class="sd">        Whether to apply a monopole correction to the data. Default is True</span>
<span class="sd">        outfile: str, optional</span>
<span class="sd">        The file in which data is to be saved. Defaults to None.</span>
<span class="sd">        nthreds: int, optional</span>
<span class="sd">        The number of thredds to use for the calculations. Defaults to None.</span>
<span class="sd">        verbose: bool, optional</span>
<span class="sd">        Show progress. Defaults to True.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        df: pd.DataFrame</span>
<span class="sd">        The dataframe containing the AFT parameters for the given files.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">nthreds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nthreds</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="n">save_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">this_directory</span><span class="p">,</span> <span class="s2">&quot;.aftpara.h5&quot;</span><span class="p">)</span>
        <span class="n">save_exist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">use_saved</span> <span class="o">&amp;</span> <span class="n">save_exist</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">h52df</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="o">==</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">float_format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%.3g</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">df</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Saved data is outdated, skipping saved data.&quot;</span><span class="p">)</span>

        <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">tint</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">bar_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{desc}</span><span class="s1">: </span><span class="si">{percentage:3.2f}</span><span class="s1">%|</span><span class="si">{bar}{r_bar}</span><span class="s1">&#39;</span>
        <span class="n">inputpara</span> <span class="o">=</span> <span class="p">[(</span><span class="n">file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_fmt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monopole_corr</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">]</span>
        <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">nthreds</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">_para</span> <span class="ow">in</span> <span class="n">tq</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">imap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_generate_para</span><span class="p">,</span> <span class="n">inputpara</span><span class="p">),</span>
                                 <span class="n">bar_format</span><span class="o">=</span><span class="n">bar_format</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">):</span>
                <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_para</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completed in </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tint</span><span class="p">)</span><span class="si">}</span><span class="s2"> seconds.&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AFT parameters are saved to </span><span class="si">{</span><span class="n">outfile</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;PolarN&quot;</span><span class="p">,</span> <span class="s2">&quot;PolarS&quot;</span><span class="p">,</span> <span class="s2">&quot;ADM&quot;</span><span class="p">,</span> <span class="s2">&quot;EDM&quot;</span><span class="p">,</span> <span class="s2">&quot;TotalFlux&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">float_format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%.3g</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">df2h5</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">save_file</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">df</span>

    <span class="k">def</span> <span class="nf">get_crmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cr_number</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cr_number</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CRN</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The given Carrington Rotation is Not present in the data.&quot;</span><span class="p">)</span>

        <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_crn</span> <span class="o">==</span> <span class="n">cr_number</span><span class="p">)</span>
        <span class="n">crmap</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">_fl</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">[</span><span class="n">ind</span><span class="p">]:</span>
            <span class="n">aftobj</span> <span class="o">=</span> <span class="n">AFTmap</span><span class="p">(</span><span class="n">_fl</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span> <span class="n">date_fmt</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">date_fmt</span><span class="p">)</span>
            <span class="n">crmap</span> <span class="o">=</span> <span class="n">crmap</span> <span class="o">+</span> <span class="n">aftobj</span><span class="o">.</span><span class="n">aftmap</span>
        <span class="n">crmap</span> <span class="o">=</span> <span class="n">crmap</span> <span class="o">/</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>
        <span class="k">return</span> <span class="n">crmap</span>

    <span class="k">def</span> <span class="nf">cravgmap</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">use_saved</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="n">save_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">this_directory</span><span class="p">,</span> <span class="s2">&quot;.bflydata.h5&quot;</span><span class="p">)</span>
        <span class="n">save_exist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">use_saved</span> <span class="o">&amp;</span> <span class="n">save_exist</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">hdf</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">save_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh5</span><span class="p">:</span>
                <span class="n">bflymap</span> <span class="o">=</span> <span class="n">fh5</span><span class="p">[</span><span class="s2">&quot;bdata&quot;</span><span class="p">][()]</span>
            <span class="k">if</span> <span class="n">bflymap</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_CRN</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">bflymap</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Saved data is outdated, skipping saved data.&quot;</span><span class="p">)</span>

        <span class="c1"># Get carrington Numbers</span>
        <span class="n">crn</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_CRN</span>
        <span class="n">crn0</span> <span class="o">=</span> <span class="n">crn</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="n">bar_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{desc}</span><span class="s1">: </span><span class="si">{percentage:3.2f}</span><span class="s1">%|</span><span class="si">{bar}{r_bar}</span><span class="s1">&#39;</span>
        <span class="n">bflymap</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">512</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">crn</span><span class="p">)))</span>
        <span class="k">for</span> <span class="n">_crn</span> <span class="ow">in</span> <span class="n">tq</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">crn</span><span class="p">,</span> <span class="n">bar_format</span><span class="o">=</span><span class="n">bar_format</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">crn</span><span class="p">)):</span>
            <span class="n">bflymap</span><span class="p">[:,</span> <span class="n">_crn</span> <span class="o">-</span> <span class="n">crn0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_crmap</span><span class="p">(</span><span class="n">_crn</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">save_exist</span><span class="p">:</span>
            <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">hdf</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">save_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh5</span><span class="p">:</span>
            <span class="n">fh5</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s2">&quot;bdata&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">bflymap</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">bflymap</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">visualize</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Visulalization</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</code></pre></div>
        </details>



  <div class="doc doc-children">






  <div class="doc doc-object doc-attribute">



<h3 id="aftpy.aftmap.AFTmaps.aftmaps" class="doc doc-heading">
<code class="highlight language-python"><span class="n">aftmaps</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>An itterator containing all the AFTmaps associated.</p>
    </div>

  </div>




  <div class="doc doc-object doc-attribute">



<h3 id="aftpy.aftmap.AFTmaps.timestamps" class="doc doc-heading">
<code class="highlight language-python"><span class="n">timestamps</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-property"><code>property</code></small>
      <small class="doc doc-property doc-property-readonly"><code>readonly</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>To get timestamps for all files in the AFT map directory.</p>
<h5 id="aftpy.aftmap.AFTmaps.timestamps--returns">Returns</h5>
<p>object
List of timestamps corresponding to each AFT map in the directory.</p>
    </div>

  </div>







  <div class="doc doc-object doc-method">



<h3 id="aftpy.aftmap.AFTmaps.__init__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">filetype</span><span class="o">=</span><span class="s1">&#39;aftmap&#39;</span><span class="p">,</span> <span class="n">date_fmt</span><span class="o">=</span><span class="s1">&#39;AFTmap_%Y%m</span><span class="si">%d</span><span class="s1">_%H%M.h5&#39;</span><span class="p">,</span> <span class="n">monopole_corr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">hipft_prop</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Initilaizing class function.</p>
<h5 id="aftpy.aftmap.AFTmaps.__init__--parameters">Parameters</h5>
<p>path: str, optional
The path to the AFT map file. Defaults to the current working directory.
filetype: str, optional
The file extension of the AFT map. Default to the "h5"
date_fmt:str, optional
The date format string. Defaults to the "AFTmap_%Y%m%d_%H%M.h5"
verbose:bool, optional
Whether to print or not. Defaults to the True
hipft_prop: dict, optional
A dictionary for hipft properties, if filetype is "hipft", the hipft</p>

        <details class="quote">
          <summary>Source code in <code>aftpy/aftmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="n">filetype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;aftmap&quot;</span><span class="p">,</span>
             <span class="n">date_fmt</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;AFTmap_%Y%m</span><span class="si">%d</span><span class="s2">_%H%M.h5&quot;</span><span class="p">,</span> <span class="n">monopole_corr</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">hipft_prop</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initilaizing class function.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path: str, optional</span>
<span class="sd">    The path to the AFT map file. Defaults to the current working directory.</span>
<span class="sd">    filetype: str, optional</span>
<span class="sd">    The file extension of the AFT map. Default to the &quot;h5&quot;</span>
<span class="sd">    date_fmt:str, optional</span>
<span class="sd">    The date format string. Defaults to the &quot;AFTmap_%Y%m%d_%H%M.h5&quot;</span>
<span class="sd">    verbose:bool, optional</span>
<span class="sd">    Whether to print or not. Defaults to the True</span>
<span class="sd">    hipft_prop: dict, optional</span>
<span class="sd">    A dictionary for hipft properties, if filetype is &quot;hipft&quot;, the hipft</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">path</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span> <span class="o">=</span> <span class="n">filetype</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">date_fmt</span> <span class="o">=</span> <span class="n">date_fmt</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span> <span class="o">=</span> <span class="n">verbose</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">monopole_corr</span> <span class="o">=</span> <span class="n">monopole_corr</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fileext</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;aftmap&quot;</span><span class="p">:</span> <span class="s2">&quot;h5&quot;</span><span class="p">,</span> <span class="s2">&quot;oldaft&quot;</span><span class="p">:</span> <span class="s2">&quot;dat&quot;</span><span class="p">,</span> <span class="s2">&quot;hipft&quot;</span><span class="p">:</span> <span class="s2">&quot;h5&quot;</span><span class="p">}</span>

    <span class="c1"># Whether it is a list of paths or one path</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)):</span>
        <span class="n">filelist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
        <span class="k">for</span> <span class="n">_path</span> <span class="ow">in</span> <span class="n">path</span><span class="p">:</span>
            <span class="n">_filelist</span> <span class="o">=</span> <span class="n">file_search</span><span class="p">(</span><span class="n">_path</span><span class="p">,</span> <span class="n">fileext</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_fileext</span><span class="p">[</span><span class="n">filetype</span><span class="p">])</span>
            <span class="n">filelist</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filelist</span><span class="p">,</span> <span class="n">_filelist</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filelist</span> <span class="o">=</span> <span class="n">filelist</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filelist</span> <span class="o">=</span> <span class="n">file_search</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">fileext</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_fileext</span><span class="p">[</span><span class="n">filetype</span><span class="p">])</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">filenames</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hipft_prop</span> <span class="o">=</span> <span class="n">hipft_prop</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filenames</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">filetype</span> <span class="o">==</span> <span class="s2">&quot;hipft&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">hipft_prop</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;HIPFT Time information not provided&quot;</span><span class="p">)</span>

    <span class="c1"># Carrington Parameters</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_crn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">carrington_rotation_number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_CRN</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_crn</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stats</span><span class="p">()</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="aftpy.aftmap.AFTmaps.__len__" class="doc doc-heading">
<code class="highlight language-python"><span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>

  <span class="doc doc-properties">
      <small class="doc doc-property doc-property-special"><code>special</code></small>
  </span>

</h3>

    <div class="doc doc-contents ">

      <p>Length of the object.
Returns</p>
<hr />
<p>n: int
Length of the object.</p>

        <details class="quote">
          <summary>Source code in <code>aftpy/aftmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Length of the object.</span>
<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    n: int</span>
<span class="sd">    Length of the object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>





  <div class="doc doc-object doc-method">



<h3 id="aftpy.aftmap.AFTmaps.convert_all" class="doc doc-heading">
<code class="highlight language-python"><span class="n">convert_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">convert_to</span><span class="o">=</span><span class="s1">&#39;fits&#39;</span><span class="p">,</span> <span class="n">outpath</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Convert all loaded AFT map files to the specified format.</p>
<h5 id="aftpy.aftmap.AFTmaps.convert_all--parameters">Parameters</h5>
<p>convert_to: str, optional
The output format to AFTMap to fits. Defaults to "fits"
outpath: str, optional
The directory in which to save the fits. Defaults to "."
Show progress. Defaults to True</p>

        <details class="quote">
          <summary>Source code in <code>aftpy/aftmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">convert_all</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">convert_to</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;fits&quot;</span><span class="p">,</span> <span class="n">outpath</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert all loaded AFT map files to the specified format.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    convert_to: str, optional</span>
<span class="sd">    The output format to AFTMap to fits. Defaults to &quot;fits&quot;</span>
<span class="sd">    outpath: str, optional</span>
<span class="sd">    The directory in which to save the fits. Defaults to &quot;.&quot;</span>
<span class="sd">    Show progress. Defaults to True</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">_file</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">))):</span>
        <span class="n">mapobj</span> <span class="o">=</span> <span class="n">AFTmap</span><span class="p">(</span><span class="n">_file</span><span class="p">)</span>
        <span class="n">yr</span><span class="p">,</span> <span class="n">mo</span><span class="p">,</span> <span class="n">day</span> <span class="o">=</span> <span class="n">mapobj</span><span class="o">.</span><span class="n">ymd</span>
        <span class="n">_outpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">yr</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">mo</span><span class="p">))</span>
        <span class="n">_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">_file</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">convert_to</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">_outpath</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">_outpath</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">convert_to</span> <span class="o">==</span> <span class="s2">&quot;png&quot;</span><span class="p">:</span>
            <span class="n">mapobj</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">convert_to</span><span class="o">=</span><span class="n">convert_to</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span> <span class="n">outpath</span><span class="o">=</span><span class="n">_outpath</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_outpath</span><span class="p">,</span> <span class="n">_filename</span><span class="p">)</span>
            <span class="n">mapobj</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="n">convert_to</span><span class="o">=</span><span class="n">convert_to</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">,</span> <span class="n">outpath</span><span class="o">=</span><span class="n">_filename</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="n">frac</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;(</span><span class="si">{</span><span class="n">frac</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%) Converting </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">_file</span><span class="p">)</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">_filename</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="aftpy.aftmap.AFTmaps.generate_parameters" class="doc doc-heading">
<code class="highlight language-python"><span class="n">generate_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nthreds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_saved</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Function to generate AFT data for all the files.
Parameters</p>
<hr />
<p>use_saved: bool, optional
Whether to relaod form saved file or not. Defaults to True.
Whether to apply a monopole correction to the data. Default is True
outfile: str, optional
The file in which data is to be saved. Defaults to None.
nthreds: int, optional
The number of thredds to use for the calculations. Defaults to None.
verbose: bool, optional
Show progress. Defaults to True.</p>
<h5 id="aftpy.aftmap.AFTmaps.generate_parameters--returns">Returns</h5>
<p>df: pd.DataFrame
The dataframe containing the AFT parameters for the given files.</p>

        <details class="quote">
          <summary>Source code in <code>aftpy/aftmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">generate_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outfile</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">nthreds</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">use_saved</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function to generate AFT data for all the files.</span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    use_saved: bool, optional</span>
<span class="sd">    Whether to relaod form saved file or not. Defaults to True.</span>
<span class="sd">    Whether to apply a monopole correction to the data. Default is True</span>
<span class="sd">    outfile: str, optional</span>
<span class="sd">    The file in which data is to be saved. Defaults to None.</span>
<span class="sd">    nthreds: int, optional</span>
<span class="sd">    The number of thredds to use for the calculations. Defaults to None.</span>
<span class="sd">    verbose: bool, optional</span>
<span class="sd">    Show progress. Defaults to True.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    df: pd.DataFrame</span>
<span class="sd">    The dataframe containing the AFT parameters for the given files.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">nthreds</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">nthreds</span> <span class="o">=</span> <span class="n">cpu_count</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="n">save_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">this_directory</span><span class="p">,</span> <span class="s2">&quot;.aftpara.h5&quot;</span><span class="p">)</span>
    <span class="n">save_exist</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">use_saved</span> <span class="o">&amp;</span> <span class="n">save_exist</span><span class="p">:</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">h52df</span><span class="p">(</span><span class="n">save_file</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">Time</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="o">==</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">float_format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%.3g</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">df</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;WARNING: Saved data is outdated, skipping saved data.&quot;</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">tint</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">bar_format</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{desc}</span><span class="s1">: </span><span class="si">{percentage:3.2f}</span><span class="s1">%|</span><span class="si">{bar}{r_bar}</span><span class="s1">&#39;</span>
    <span class="n">inputpara</span> <span class="o">=</span> <span class="p">[(</span><span class="n">file</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">date_fmt</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">monopole_corr</span><span class="p">)</span> <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">]</span>
    <span class="k">with</span> <span class="n">Pool</span><span class="p">(</span><span class="n">nthreds</span><span class="p">)</span> <span class="k">as</span> <span class="n">pool</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">_para</span> <span class="ow">in</span> <span class="n">tq</span><span class="o">.</span><span class="n">tqdm</span><span class="p">(</span><span class="n">pool</span><span class="o">.</span><span class="n">imap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_generate_para</span><span class="p">,</span> <span class="n">inputpara</span><span class="p">),</span>
                             <span class="n">bar_format</span><span class="o">=</span><span class="n">bar_format</span><span class="p">,</span> <span class="n">total</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">):</span>
            <span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">_para</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Completed in </span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">tint</span><span class="p">)</span><span class="si">}</span><span class="s2"> seconds.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AFT parameters are saved to </span><span class="si">{</span><span class="n">outfile</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="s2">&quot;PolarN&quot;</span><span class="p">,</span> <span class="s2">&quot;PolarS&quot;</span><span class="p">,</span> <span class="s2">&quot;ADM&quot;</span><span class="p">,</span> <span class="s2">&quot;EDM&quot;</span><span class="p">,</span> <span class="s2">&quot;TotalFlux&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">outfile</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">float_format</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">%.3g</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">df2h5</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">save_file</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span>
</code></pre></div>
        </details>
    </div>

  </div>




  <div class="doc doc-object doc-method">



<h3 id="aftpy.aftmap.AFTmaps.get_filelist" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_filelist</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>To get the full paths of the loaded files in the AFTmaps folder.</p>
<h5 id="aftpy.aftmap.AFTmaps.get_filelist--returns">Returns</h5>
<p>np.ndarray
List of all files in the AFTmaps directory.</p>

        <details class="quote">
          <summary>Source code in <code>aftpy/aftmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_filelist</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    To get the full paths of the loaded files in the AFTmaps folder.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">    List of all files in the AFTmaps directory.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">filelist</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="aftpy.aftmap.AFTmaps.get_filenames" class="doc doc-heading">
<code class="highlight language-python"><span class="n">get_filenames</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Returns the names of the files in the AFTMap directory.</p>
<h5 id="aftpy.aftmap.AFTmaps.get_filenames--returns">Returns</h5>
<p>np.ndarray
list of filenames.</p>

        <details class="quote">
          <summary>Source code in <code>aftpy/aftmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">get_filenames</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the names of the files in the AFTMap directory.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    np.ndarray</span>
<span class="sd">    list of filenames.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filenames</span><span class="p">)</span>
</code></pre></div>
        </details>
    </div>

  </div>



  <div class="doc doc-object doc-method">



<h3 id="aftpy.aftmap.AFTmaps.stats" class="doc doc-heading">
<code class="highlight language-python"><span class="n">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></code>


</h3>

    <div class="doc doc-contents ">

      <p>Show the statistics of the loaded files.</p>

        <details class="quote">
          <summary>Source code in <code>aftpy/aftmap.py</code></summary>
          <div class="highlight"><pre><span></span><code><span class="k">def</span> <span class="nf">stats</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Show the statistics of the loaded files.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_stats</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;RootDir&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;FileType&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">filetype</span><span class="p">,</span> <span class="s2">&quot;# Files&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">filelist</span><span class="p">),</span>
              <span class="s2">&quot;T-Initial&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;T-End&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">timestamps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]}</span>
    <span class="k">for</span> <span class="n">_s</span> <span class="ow">in</span> <span class="n">_stats</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%-10s</span><span class="s2">: </span><span class="si">%-30s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">_s</span><span class="p">,</span> <span class="n">_stats</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">_s</span><span class="p">)))</span>
</code></pre></div>
        </details>
    </div>

  </div>





  </div>

    </div>

  </div>







  </div>

    </div>

  </div>

<p>options:
      docstring_options:
        ignore_init_summary: true
        docstring_section_style: table
        docstring_style: numpy</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>